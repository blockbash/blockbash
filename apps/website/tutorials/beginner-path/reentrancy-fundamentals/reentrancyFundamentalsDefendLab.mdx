---
title: "Defend Lab"
description: "Learn how to protect your smart contracts from reentrancy vulnerabilities. Get hands-on experience with defense patterns like Checks-Effects-Interactions (CEI). Perfect for Solidity developers seeking to enhance their smart contract security skills."
keywords:
  - smart contract security
  - reentrancy vulnerability
  - solidity security
  - reentrancy guard
  - checks effects interactions
  - smart contract defense patterns
  - blockchain security
  - cross-function reentrancy
  - cross contract reentrancy
  - read only reentrancy
  - contract invariants
  - state variable security
  - solidity best practices
  - smart contract attacks
  - ethereum security
  - web3 security
  - defi security
  - blockchain vulnerabilities
sidebar_position: 5
slug: "/tutorials/reentrancy-fundamentals-defend-lab"
hide_title: true
hide_table_of_contents: true
---

<!-- Intellij mdx plugin doesn't support ts path aliases -->
import {chakra, Code} from "@chakra-ui/react"
import {tutorialConfigConst} from "@blockbash/common"
import {ChallengePromptSection, LinkAnchor, LinkTutorial, Warning} from "../../../src/components"
import {Help, LabOptions, LabSample, LabWorkflow, Liability} from "../../../src/features"

## Introduction

- It's time for some hands-on experience!
- In this lab, you'll leverage the Checks-Effects-Interactions (CEI) pattern to fix the Reentrancy vulnerability in
<LinkTutorial tutorialGUID={tutorialConfigConst.TutorialGUID.reentrancyFundamentalsDefendTheory} content="Vulnerable.sol" anchorGUID={tutorialConfigConst.AnchorGUID.primaryCode}/>.  If you implement the CEI pattern correctly, the attack you created in <LinkTutorial tutorialGUID={tutorialConfigConst.TutorialGUID.reentrancyFundamentalsAttackLab}/> should NOT work.
- As discussed in the <LinkTutorial tutorialGUID={tutorialConfigConst.TutorialGUID.reentrancyFundamentalsAttackLab} anchorGUID={tutorialConfigConst.AnchorGUID.labWorkflow}/> section, your solution will be verified by the Challenge Verification Engine.
- For you to pass the lab, you must complete the <LinkAnchor anchorGUID={tutorialConfigConst.AnchorGUID.labChallenges}/>.

## Prerequisites

- <LinkTutorial tutorialGUID={tutorialConfigConst.TutorialGUID.reentrancyFundamentalsAttackTheory}/>
- <LinkTutorial tutorialGUID={tutorialConfigConst.TutorialGUID.reentrancyFundamentalsDefendTheory}/>


## Lab Sample
<LabSample/>


## Lab Challenges {#labChallenges}

<ChallengePromptSection challenges={[
    {
        id: 1,
        title: tutorialConfigConst.ChallengeDescriptions.shouldNotBeAbleToStealAllEthFromVulnerableContract,
        additionalContent: <Warning labelOverride={"Important"}>
            <chakra.span>While you can solve this challenge in multiple ways, please use the Checks-Effects-Interactions Pattern.</chakra.span>
        </Warning>,
        hints: [
            {
                title: <>Where should I begin?</>,
                content: (
                    <chakra.span>
                        Review <LinkTutorial
                            content={"Defense Pattern 3: Checks-Effect-Interactions"}
                            tutorialGUID={tutorialConfigConst.TutorialGUID.reentrancyFundamentalsDefendTheory}
                            anchorGUID={tutorialConfigConst.AnchorGUID.pattern3Section}/>.
                    </chakra.span>),
                id: 1
            }
        ]
    }
]}/>

## Lab Workflow {#labWorkflow}
<LabWorkflow tutorialTypeGUID={tutorialConfigConst.TutorialTypeGUID.defendLab} updateContractCTA={(
<chakra.span>
    Update <Code>Vulnerable.sol</Code> for the Checks-Effects-Interactions pattern.
</chakra.span>
)} tutorialGUID={tutorialConfigConst.TutorialGUID.reentrancyFundamentalsDefendLab}/>

## Lab Options {#labOptions}
<LabOptions
    Goal={
        <chakra.span>
            In this lab, you'll leverage your Reentrancy knowledge to steal funds from
            the <Code>Vulnerable</Code> Contract!
        </chakra.span>
    }
    tutorialGUID={
        tutorialConfigConst.TutorialGUID.reentrancyFundamentalsDefendLab
    }
/>

## Need Help? {#needHelp}
<Help tutorialGUID={tutorialConfigConst.TutorialGUID.reentrancyFundamentalsDefendLab}></Help>

## Disclosures
<Liability/>
